<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Election Commissioner Admin</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      min-height: 100vh;
      background: linear-gradient(135deg, #e0eafc, #cfdef3);
    }

    .container {
      display: flex;
      width: 100%;
    }

    .sidebar {
      width: 250px;
      background: linear-gradient(135deg, #1e3c72, #2a5298);
      color: white;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 20px 10px;
      transition: all 0.3s ease;
    }

    .logo {
      font-size: 22px;
      font-weight: bold;
      text-align: center;
      margin-bottom: 30px;
    }

    .nav .tab {
      padding: 15px 20px;
      margin: 10px;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.1);
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 16px;
    }

    .nav .tab:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateX(5px);
    }

    .nav .active {
      background: #f39c12;
      color: #fff;
      font-weight: bold;
      box-shadow: 0 0 10px #f39c12;
    }

    .logout {
      padding: 15px 20px;
      margin: 10px;
      text-align: center;
      border-radius: 8px;
      background: #e74c3c;
      cursor: pointer;
      font-weight: bold;
      transition: background 0.3s;
    }

    .logout:hover {
      background: #c0392b;
    }

    .content {
      flex: 1;
      padding: 40px;
      background: #f8f9fa;
      overflow-y: auto;
    }

    .content h1 {
      font-size: 28px;
      color: #333;
    }

    @media (max-width: 768px) {
      .container {
        flex-direction: column;
      }

      .sidebar {
        flex-direction: row;
        overflow-x: auto;
        width: 100%;
        padding: 10px;
        justify-content: space-around;
      }

      .nav {
        display: flex;
        flex-direction: row;
        gap: 10px;
      }

      .nav .tab {
        flex: 1;
        padding: 10px;
        font-size: 14px;
        text-align: center;
      }

      .logout {
        margin: 0;
        font-size: 14px;
        padding: 10px;
      }

      .content {
        padding: 20px;
      }
    }

    .form-container {
      background: linear-gradient(135deg, #ffffff, #f0f0f0);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      max-width: 600px;
      margin: 20px auto;
    }
    .form-group {
      margin-bottom: 15px;
    }
    .form-group label {
      display: block;
      font-weight: bold;
      margin-bottom: 5px;
      color: #333;
    }
    .form-group input,
    .form-group textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 16px;
    }
    .form-group input[type="file"] {
      padding: 5px;
    }
    .form-group textarea {
      resize: none;
    }
    .submit-button {
      background: linear-gradient(to right, #4caf50, #81c784);
      color: white;
      font-weight: bold;
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: transform 0.2s ease, background-color 0.3s ease;
    }
    .submit-button:hover {
      transform: scale(1.05);
      background: linear-gradient(to right, #388e3c, #66bb6a);
    }
    @media (max-width: 768px) {
      .form-container {
        padding: 15px;
      }
      .form-group input,
      .form-group textarea {
        font-size: 14px;
      }
      .submit-button {
        padding: 8px 16px;
      }
    }

    /* Toast notifications */
    .toast-container {
      position: fixed;
      top: 20px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      z-index: 9999;
      pointer-events: none; /* let clicks pass through except on toasts */
    }
    .toast {
      min-width: 320px;
      max-width: 420px;
      color: #0f172a;
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
      display: grid;
      grid-template-columns: auto 1fr auto;
      align-items: start;
      gap: 12px;
      padding: 14px 16px;
      border-left: 6px solid #10b981;
      transform: translateX(120%);
      animation: slideInRight 300ms ease-out forwards;
      pointer-events: auto;
    }
    .toast.error { border-left-color: #ef4444; }
    .toast.success { border-left-color: #10b981; }
    .toast .toast-icon {
      width: 36px; height: 36px; border-radius: 999px;
      display: grid; place-items: center;
      background: radial-gradient( circle at 30% 30%, rgba(255,255,255,0.9), rgba(255,255,255,0.6) ), #d1fae5;
      color: #065f46;
    }
    .toast.error .toast-icon { background: #fee2e2; color: #7f1d1d; }
    .toast .toast-title { font-weight: 700; margin-top: 2px; color: #0f172a; }
    .toast .toast-message { color: #334155; font-size: 14px; line-height: 1.35; }
    .toast .toast-close {
      background: transparent; border: 0; color: #475569; cursor: pointer; font-size: 18px; padding: 2px 6px;
      border-radius: 6px;
    }
    .toast .toast-close:hover { background: #f1f5f9; }
    .toast .toast-progress {
      grid-column: 1 / -1;
      height: 3px; background: #e2e8f0; border-radius: 999px; overflow: hidden; margin-top: 8px;
    }
    .toast .toast-progress > span {
      display: block; height: 100%; background: linear-gradient(to right, #10b981, #059669);
      animation: shrink linear forwards;
    }
    .toast.error .toast-progress > span {
      background: linear-gradient(to right, #ef4444, #dc2626);
    }
    @keyframes slideInRight {
      from { transform: translateX(120%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }
    @keyframes shrink {
      from { width: 100%; }
      to { width: 0%; }
    }
  </style>
</head>
<body>
  <div class="container">
    <aside class="sidebar">
      <div>
        <div class="logo">üó≥Ô∏è Admin Panel</div>
        <div class="nav">
          <div class="tab active" onclick="changeTab(this, 'dashboard')">üìä Dashboard</div>
          <div class="tab" onclick="changeTab(this, 'voters')">üßë‚Äçü§ù‚Äçüßë Voters</div>
          <div class="tab" onclick="changeTab(this, 'stats')">üìà Stats</div>
          <div class="tab" onclick="changeTab(this, 'audit')">üìã Audit Log</div>
          <div class="tab" onclick="changeTab(this, 'config')">‚öôÔ∏è Config</div>
          <div class="tab" onclick="changeTab(this, 'settings')">üîÑ Reset</div>
        </div>
      </div>
      <div class="logout" onclick="logout()">üö™ Logout</div>
    </aside>
    <main class="content" id="mainContent">
      <h1>Welcome to the Dashboard</h1>
      <p>This is your main admin area. Choose a tab to explore different sections.</p>
    </main>
  </div>

  <script>
    function changeTab(element, section) {
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      element.classList.add('active');

      const content = document.getElementById('mainContent');
      switch (section) {
        case 'dashboard':
          content.innerHTML = `
            <h1>üìä Dashboard</h1>
            <p>Add the details of the Candidates:</p>
            <form id="dashboardForm" class="form-container" enctype="multipart/form-data">
              <div class="form-group">
                <label for="name">Name</label>
                <input type="text" id="name" name="name" placeholder="Name of the Candidate" required />
              </div>
              <div class="form-group">
                <label for="class">Class</label>
                <input type="text" id="class" name="class" placeholder="Candidate's Class" required />
              </div>
              <div class="form-group">
                <label for="role">Role / Post</label>
                <input type="text" id="role" name="role" placeholder="e.g., President, Secretary" required />
              </div>
              <div class="form-group">
                <label for="photo">Upload Photo</label>
                <input type="file" id="photo" name="photo" accept="image/*" required />
              </div>
              <div class="form-group">
                <label for="description">Description</label>
                <textarea id="description" name="description" placeholder="Enter a description" rows="4" required></textarea>
              </div>
              <button type="submit" class="submit-button">Submit</button>
            </form>
          `;

          document.getElementById('dashboardForm').addEventListener('submit', async function (e) {
            e.preventDefault();

            const formData = new FormData(this);

            const response = await fetch('/add-candidate', {
              method: 'POST',
              body: formData,
            });

            const result = await response.json();

            if (result.success) {
              alert('Candidate added successfully!');
            } else {
              alert(result.message || 'Failed to add candidate.');
            }
          });
          break;
        case 'voters':
          fetch('/get-voters')
            .then(response => response.json())
            .then(data => {
              const votersTable = `
                <style>
                  .voters-table-container {
                    overflow-x: auto;
                    background: #ffffff;
                    border-radius: 12px;
                    padding: 20px;
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
                    margin-top: 20px;
                  }
                  .voters-table {
                    width: 100%;
                    border-collapse: collapse;
                    font-family: 'Segoe UI', sans-serif;
                  }
                  .voters-table thead {
                    background: linear-gradient(to right, #6a11cb, #2575fc);
                    color: white;
                  }
                  .voters-table th,
                  .voters-table td {
                    padding: 14px 16px;
                    text-align: left;
                    border-bottom: 1px solid #ddd;
                  }
                  .voters-table tbody tr:hover {
                    background: #f1f5ff;
                    transition: background 0.3s;
                  }
                  .voted-badge {
                    background: linear-gradient(to right, #4caf50, #66bb6a);
                    color: white;
                    padding: 6px 12px;
                    border-radius: 20px;
                    font-weight: bold;
                    display: inline-block;
                    text-align: center;
                  }
                  .not-voted-badge {
                    background: linear-gradient(to right, #e53935, #e35d5b);
                    color: white;
                    padding: 6px 12px;
                    border-radius: 20px;
                    font-weight: bold;
                    display: inline-block;
                    text-align: center;
                  }
                  @media (max-width: 768px) {
                    .voters-table th, .voters-table td {
                      padding: 10px 12px;
                      font-size: 14px;
                    }
                  }
                </style>

                <h1 style="font-size: 2rem; font-weight: bold; color: #333; text-align: center; margin-bottom: 10px;">üßë‚Äçü§ù‚Äçüßë Voters</h1>
                <p style="text-align: center; color: #555; font-size: 1rem; margin-bottom: 20px;">Manage registered voters here.</p>

                <div class="voters-table-container">
                  <table class="voters-table">
                    <thead>
                      <tr>
                        <th>Name</th>
                        <th>Username</th>
                        <th>Email</th>
                        <th>Voting Status</th>
                      </tr>
                    </thead>
                    <tbody>
                      ${data.map(voter => `
                        <tr>
                          <td>${voter.name}</td>
                          <td>${voter.username}</td>
                          <td>${voter.email}</td>
                          <td>
                            <span class="${voter.voted ? 'voted-badge' : 'not-voted-badge'}">
                              ${voter.voted ? 'Voted' : 'Not Voted'}
                            </span>
                          </td>
                        </tr>
                      `).join('')}
                    </tbody>
                  </table>
                </div>
              `;
              document.getElementById('mainContent').innerHTML = votersTable;
            })
            .catch(err => {
              console.error(err);
              document.getElementById('mainContent').innerHTML = '<p style="color: red; text-align: center;">Error loading voters data.</p>';
            });
          break;
        case 'stats':
          fetch('/get-stats')
            .then(response => response.json())
            .then(data => {
              const styleBlock = `
                <style>
                  .stats-table-container { overflow-x: auto; background: #ffffff; border-radius: 12px; padding: 20px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); margin-top: 20px; }
                  .stats-table { width: 100%; border-collapse: collapse; font-family: 'Segoe UI', sans-serif; }
                  .stats-table thead { background: linear-gradient(to right, #6a11cb, #2575fc); color: white; }
                  .stats-table th, .stats-table td { padding: 14px 16px; text-align: left; border-bottom: 1px solid #ddd; }
                  .stats-table tbody tr:hover { background: #f1f5ff; transition: background 0.3s; }
                  .candidate-photo { width: 50px; height: 50px; border-radius: 50%; object-fit: cover; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2); }
                  .role-header { margin-top: 28px; display: flex; align-items: center; gap: 10px; color: #334155; }
                  .role-badge { display: inline-flex; align-items: center; gap: 8px; padding: 6px 12px; border-radius: 999px; background: #eef2ff; color: #3730a3; font-weight: 700; }
                  .save-button { margin: 30px auto 0; display: block; padding: 12px 24px; background: linear-gradient(to right, #4a90e2, #007aff); color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.15); transition: background 0.3s ease; }
                  .save-button:hover { background: linear-gradient(to right, #007aff, #0051c7); }
                  @media (max-width: 768px) { .stats-table th, .stats-table td { padding: 10px 12px; font-size: 14px; } }
                </style>
              `;

              // Group by role (default to 'General')
              const byRole = data.reduce((acc, item) => {
                const role = (item.role || 'General');
                (acc[role] = acc[role] || []).push(item);
                return acc;
              }, {});

              const roleSections = Object.keys(byRole).sort().map(role => {
                const rows = byRole[role]
                  .sort((a,b) => b.votes - a.votes || a.name.localeCompare(b.name))
                  .map(candidate => `
                    <tr>
                      <td>${candidate.name}</td>
                      <td><img src="${candidate.photo}" alt="Candidate Photo" class="candidate-photo" /></td>
                      <td>${candidate.class}</td>
                      <td>${candidate.votes}</td>
                    </tr>
                  `).join('');

                return `
                  <div class="role-header">
                    <span class="role-badge">üè∑Ô∏è ${role}</span>
                  </div>
                  <div class="stats-table-container">
                    <table class="stats-table">
                      <thead>
                        <tr>
                          <th>Name</th>
                          <th>Photo</th>
                          <th>Class</th>
                          <th>Votes</th>
                        </tr>
                      </thead>
                      <tbody>${rows}</tbody>
                    </table>
                  </div>
                `;
              }).join('');

              const html = `
                ${styleBlock}
                <h1 style="font-size: 2rem; font-weight: bold; color: #333; text-align: center; margin-bottom: 10px;">üìà Statistics</h1>
                <p style="text-align: center; color: #555; font-size: 1rem; margin-bottom: 10px;">View real-time voting stats grouped by role.</p>
                ${roleSections}
                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 30px;">
                  <button onclick="saveResults()" class="save-button">üíæ Save Results</button>
                  <button onclick="exportResults()" class="save-button" style="background: linear-gradient(to right, #f093fb, #f5576c);">üì• Export as CSV</button>
                </div>
              `;

              document.getElementById('mainContent').innerHTML = html;
            })
            .catch(err => {
              console.error(err);
              document.getElementById('mainContent').innerHTML = '<p style="color: red; text-align: center;">Error loading statistics data.</p>';
            });
          break;
        case 'audit':
          fetch('/admin/audit-log')
            .then(res => res.json())
            .then(data => {
              if (data.success) {
                const auditTable = `
                  <style>
                    .audit-container {
                      max-width: 1200px;
                      margin: 20px auto;
                      background: white;
                      padding: 30px;
                      border-radius: 12px;
                      box-shadow: 0 6px 18px rgba(0,0,0,0.1);
                    }
                    .audit-table {
                      width: 100%;
                      border-collapse: collapse;
                      font-size: 14px;
                    }
                    .audit-table thead {
                      background: linear-gradient(to right, #667eea, #764ba2);
                      color: white;
                    }
                    .audit-table th,
                    .audit-table td {
                      padding: 12px;
                      text-align: left;
                      border-bottom: 1px solid #ddd;
                    }
                    .audit-table tbody tr:hover {
                      background: #f5f5f5;
                    }
                  </style>
                  <h1 style="font-size: 2rem; margin-bottom: 20px;">üìã Audit Log</h1>
                  <div class="audit-container">
                    <table class="audit-table">
                      <thead>
                        <tr>
                          <th>Timestamp</th>
                          <th>Action</th>
                          <th>Username</th>
                          <th>Email</th>
                          <th>IP Address</th>
                          <th>Details</th>
                        </tr>
                      </thead>
                      <tbody>
                        ${data.logs.map(log => `
                          <tr>
                            <td>${new Date(log.timestamp).toLocaleString()}</td>
                            <td><strong>${log.action}</strong></td>
                            <td>${log.username || '-'}</td>
                            <td>${log.email || '-'}</td>
                            <td>${log.ip_address || '-'}</td>
                            <td>${log.details || '-'}</td>
                          </tr>
                        `).join('')}
                      </tbody>
                    </table>
                  </div>
                `;
                document.getElementById('mainContent').innerHTML = auditTable;
              }
            });
          break;

        case 'config':
          fetch('/admin/election-config')
            .then(res => res.json())
            .then(data => {
              if (data.success) {
                const configHtml = `
                  <style>
                    .config-container {
                      max-width: 700px;
                      margin: 40px auto;
                      background: white;
                      padding: 30px;
                      border-radius: 12px;
                      box-shadow: 0 6px 18px rgba(0,0,0,0.1);
                    }
                    .config-item {
                      margin-bottom: 20px;
                      padding: 15px;
                      background: #f9f9f9;
                      border-left: 4px solid #667eea;
                      border-radius: 4px;
                    }
                    .config-item label {
                      display: block;
                      font-weight: bold;
                      margin-bottom: 8px;
                      color: #333;
                    }
                    .config-item input[type="checkbox"] {
                      margin-right: 8px;
                      cursor: pointer;
                    }
                    .config-item input[type="datetime-local"] {
                      padding: 8px;
                      border: 1px solid #ddd;
                      border-radius: 4px;
                      width: 100%;
                    }
                    .config-button {
                      background: linear-gradient(to right, #667eea, #764ba2);
                      color: white;
                      padding: 12px 30px;
                      border: none;
                      border-radius: 8px;
                      cursor: pointer;
                      font-weight: bold;
                      transition: transform 0.2s;
                    }
                    .config-button:hover {
                      transform: translateY(-2px);
                    }
                  </style>
                  <h1 style="font-size: 2rem; margin-bottom: 20px;">‚öôÔ∏è Election Configuration</h1>
                  <div class="config-container">
                    <div class="config-item">
                      <label>
                        <input type="checkbox" id="enable_countdown" ${data.config.enable_countdown_timer ? 'checked' : ''}>
                        Enable Countdown Timer
                      </label>
                    </div>
                    <div class="config-item">
                      <label>Election End Time:</label>
                      <input type="datetime-local" id="election_end_time" value="${data.config.election_end_time ? data.config.election_end_time.slice(0, 16) : ''}">
                    </div>
                    <div class="config-item">
                      <label>
                        <input type="checkbox" id="enable_email" ${data.config.enable_email_notifications ? 'checked' : ''}>
                        Enable Email Notifications
                      </label>
                    </div>
                    <div class="config-item">
                      <label>
                        <input type="checkbox" id="enable_2fa" ${data.config.enable_2fa ? 'checked' : ''}>
                        Enable Two-Factor Authentication (2FA)
                      </label>
                    </div>
                    <div class="config-item">
                      <label>
                        <input type="checkbox" id="enable_audit" ${data.config.enable_audit_logging ? 'checked' : ''}>
                        Enable Audit Logging
                      </label>
                    </div>
                    <div class="config-item">
                      <label>
                        <input type="checkbox" id="enable_export" ${data.config.enable_export ? 'checked' : ''}>
                        Enable Export Results
                      </label>
                    </div>
                    <button class="config-button" onclick="saveConfig()">üíæ Save Configuration</button>
                  </div>
                `;
                document.getElementById('mainContent').innerHTML = configHtml;
              }
            });
          break;

          case 'settings':
  content.innerHTML = `
    <style>
      .settings-container {
        max-width: 600px;
        margin: 40px auto;
        background: #ffffff;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.1);
        font-family: 'Segoe UI', sans-serif;
        text-align: center;
      }
      .settings-container h1 {
        font-size: 2rem;
        font-weight: bold;
        color: #2c3e50;
        margin-bottom: 10px;
      }
      .settings-container p {
        font-size: 1rem;
        color: #555;
        margin-bottom: 30px;
      }
      .delete-button {
        padding: 14px 28px;
        background: linear-gradient(to right, #e74c3c, #c0392b);
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        transition: background 0.3s ease;
      }
      .delete-button:hover {
        background: linear-gradient(to right, #c0392b, #962d22);
      }
    </style>

    <div class="settings-container">
      <h1>‚öôÔ∏è Settings</h1>
      <p>Configure system preferences and controls.</p>
      <button onclick="deleteElection()" class="delete-button">üóëÔ∏è Delete Election</button>
    </div>
  `;
  break;

      }
    }

    async function saveResults() {
      try {
        const response = await fetch('/save-results', { method: 'POST' });
        const result = await response.json();

        if (result.success) {
          showModal('Results saved successfully!');
        } else {
          showModal(result.message || 'Failed to save results.');
        }
      } catch (err) {
        console.error(err);
        showModal('An error occurred while saving results.');
      }
    }

    async function exportResults() {
      try {
        window.location.href = '/export-results';
        showModal('Results exported as CSV!');
      } catch (err) {
        console.error(err);
        showModal('An error occurred while exporting results.');
      }
    }

    async function saveConfig() {
      try {
        const config = {
          enable_countdown_timer: document.getElementById('enable_countdown').checked,
          election_end_time: document.getElementById('election_end_time').value,
          enable_email_notifications: document.getElementById('enable_email').checked,
          enable_2fa: document.getElementById('enable_2fa').checked,
          enable_audit_logging: document.getElementById('enable_audit').checked,
          enable_export: document.getElementById('enable_export').checked
        };

        const response = await fetch('/admin/election-config', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(config)
        });
        const result = await response.json();

        if (result.success) {
          showModal('‚úÖ Configuration saved successfully!');
        } else {
          showModal('‚ùå ' + (result.message || 'Failed to save configuration.'));
        }
      } catch (err) {
        console.error(err);
        showModal('‚ùå An error occurred while saving configuration.');
      }
    }

    async function deleteElection() {
  const confirmation = confirm('‚ö†Ô∏è Are you sure you want to delete all election data? This action cannot be undone.');
  if (!confirmation) return;

  try {
    const response = await fetch('/delete-election', { method: 'POST' });
    const result = await response.json();

    if (result.success) {
      showModal('üóëÔ∏è All the tables have been deleted. You can now conduct a new election.');
    } else {
      showModal(result.message || '‚ùå Failed to delete election data.');
    }
  } catch (err) {
    console.error(err);
    showModal('üö´ An error occurred while deleting election data.');
  }
}

    function showModal(message) {
      // Infer type from message content
      const lower = String(message || '').toLowerCase();
      const isError = lower.includes('fail') || lower.includes('error') || lower.includes('‚ùå') || lower.includes('üö´');
      const type = isError ? 'error' : 'success';
      const title = isError ? 'Error' : 'Success';

      // Ensure container exists
      let container = document.getElementById('toastContainer');
      if (!container) {
        container = document.createElement('div');
        container.id = 'toastContainer';
        container.className = 'toast-container';
        document.body.appendChild(container);
      }

      // Create toast element
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      const durationMs = 4000;
      toast.innerHTML = `
        <div class="toast-icon">${isError ? '‚ùå' : '‚úÖ'}</div>
        <div>
          <div class="toast-title">${title}</div>
          <div class="toast-message">${message}</div>
        </div>
        <button class="toast-close" aria-label="Close">‚úï</button>
        <div class="toast-progress"><span style="animation-duration:${durationMs}ms"></span></div>
      `;

      // Wire close behaviour
      const close = () => {
        toast.style.animation = 'fadeOut 200ms ease-in forwards';
        setTimeout(() => toast.remove(), 220);
      };
      toast.querySelector('.toast-close').addEventListener('click', close);

      // Auto-dismiss
      setTimeout(close, durationMs + 50);

      container.appendChild(toast);
    }

    function closeModal() {
      const container = document.getElementById('toastContainer');
      if (container) container.remove();
    }

    function logout() {
      window.location.href = '/';
    }
  </script>
</body>
</html>
